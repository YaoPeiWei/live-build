# Debian Live 手册

## 自定义概述

本章概述了自定义实时系统的各种方法。

### 7.1 构建时与启动时配置

实时系统配置选项分为构建时选项和启动时选项。启动时选项进一步分为启动早期由 _live-boot_ 包应用的选项和启动后期由 _live-config_ 应用的选项。用户可以通过在启动提示符中指定来修改任何启动时选项。镜像也可以使用默认的启动参数构建，因此当所有默认设置合适时，用户通常可以直接启动到实时系统，而无需指定任何选项。特别是，`lb --bootappend-live` 的参数由实时系统的任何默认内核命令行选项组成，例如持久性、键盘布局或时区。有关自定义语言环境和语言的示例，请参见相关章节。

构建时配置选项在 `lb config` 手册页中描述。启动时选项在 _live-boot_ 和 _live-config_ 的手册页中描述。尽管 _live-boot_ 和 _live-config_ 包安装在您正在构建的实时系统中，但建议您也在构建系统上安装它们，以便在配置时轻松参考。这样做是安全的，因为除非系统配置为实时系统，否则其中包含的脚本不会执行。

### 7.2 构建阶段

构建过程分为多个阶段，每个阶段按顺序应用各种自定义。第一个运行的阶段是 **bootstrap** 阶段。这是用软件包填充 chroot 目录以创建一个基本 Debian 系统的初始阶段。接下来是 **chroot** 阶段，它完成了 chroot 目录的构建，填充了配置中列出的所有软件包以及其他材料。大多数内容的自定义发生在此阶段。准备实时映像的最后阶段是 **binary** 阶段，它使用 chroot 目录的内容构建可启动映像，以构建实时系统的根文件系统，并在目标介质上包含安装程序和任何其他附加材料。构建实时映像后，如果启用，则在 **source** 阶段构建源代码压缩包。

在每个阶段中，命令的应用顺序是特定的。这些命令的安排方式确保自定义可以以合理的方式分层。例如，在 **chroot** 阶段，预设在安装任何软件包之前应用，软件包在复制任何本地包含的文件之前安装，钩子在所有材料到位后运行。

### 7.3 使用文件补充 lb config

尽管 `lb config` 在 `config/` 目录中创建了一个骨架配置，但为了实现您的目标，您可能需要在 `config/` 的子目录中提供其他文件。根据文件在配置中的存储位置，它们可能会被复制到实时系统的文件系统或二进制映像文件系统中，或者可能提供系统的构建时配置，这些配置通过命令行选项传递会很麻烦。您可以包括自定义的软件包列表、自定义艺术作品或在构建时或启动时运行的钩子脚本，从而通过您自己的代码增强 Debian Live 的灵活性。

### 7.4 自定义任务

以下章节按用户通常执行的自定义任务组织：自定义软件包安装、自定义内容和自定义语言环境和语言仅涵盖您可能想要执行的一些操作。 